(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[332],{1815:()=>{},2787:()=>{},2936:(e,t,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return a(8634)}])},3237:()=>{},7492:()=>{},7640:()=>{},8634:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>T});var s=a(7876),n=a(2934),l=a(4232);function r(){let[e,t]=(0,l.useState)(""),[a,r]=(0,l.useState)(""),[i,o]=(0,l.useState)(""),c=async t=>{t.preventDefault(),o(""),(await (0,n.signIn)("credentials",{redirect:!1,username:e,password:a})).error?o("Invalid credentials"):window.location.href="/"};return(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:(0,s.jsxs)("form",{onSubmit:c,className:"bg-white p-6 rounded shadow-md space-y-4 w-full max-w-sm",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-center",children:"AI Agent Dashboard Login"}),i&&(0,s.jsx)("p",{className:"text-red-600 text-sm",children:i}),(0,s.jsx)("input",{type:"text",placeholder:"Username",value:e,onChange:e=>t(e.target.value),className:"w-full p-2 border rounded",required:!0}),(0,s.jsx)("input",{type:"password",placeholder:"Password",value:a,onChange:e=>r(e.target.value),className:"w-full p-2 border rounded",required:!0}),(0,s.jsx)("button",{type:"submit",className:"w-full bg-blue-600 text-white py-2 rounded hover:bg-blue-700",children:"Login"})]})})}var i=a(3576),o=a(5699);function c(e){var{className:t=""}=e,a=(0,o._)(e,["className"]);return(0,s.jsx)("div",(0,i._)({className:"rounded-xl border bg-white text-black shadow-sm ".concat(t)},a))}function d(e){var{className:t=""}=e,a=(0,o._)(e,["className"]);return(0,s.jsx)("div",(0,i._)({className:"p-4 ".concat(t)},a))}var u=a(2701);function m(e){var{children:t,className:a=""}=e,n=(0,o._)(e,["children","className"]);return(0,s.jsx)("button",(0,u._)((0,i._)({className:"px-4 py-2 rounded-xl bg-black text-white hover:bg-gray-800 transition ".concat(a)},n),{children:t}))}var h=a(1558);let x=h.bL,p=h.l9;h.ZL;let g=l.forwardRef((e,t)=>{var{className:a}=e,n=(0,o._)(e,["className"]);return(0,s.jsx)(h.hJ,(0,i._)({ref:t,className:"fixed inset-0 bg-black/50 backdrop-blur-sm ".concat(a)},n))});g.displayName="DialogOverlay";let b=l.forwardRef((e,t)=>{var{className:a}=e,n=(0,o._)(e,["className"]);return(0,s.jsxs)(h.ZL,{children:[(0,s.jsx)(g,{}),(0,s.jsx)(h.UC,(0,i._)({ref:t,className:"fixed left-[50%] top-[50%] max-h-[90vh] w-full max-w-4xl translate-x-[-50%] translate-y-[-50%] rounded-xl bg-white p-6 shadow-lg ".concat(a)},n))]})});b.displayName="DialogContent";let f=e=>{var{className:t}=e,a=(0,o._)(e,["className"]);return(0,s.jsx)("div",(0,i._)({className:"mb-4 ".concat(t)},a))};f.displayName="DialogHeader";let j=h.hE,w=h.VY;a(9688);var y=a(2098),N=a(5940),v=a(1040),C=a(3112),k=a(3448),S=a.n(k),A=a(5364);function D(e){let{value:t,onChange:a,placeholder:n}=e;return(0,s.jsx)("textarea",{value:t,onChange:a,placeholder:n,rows:4,className:"w-full p-2 border border-gray-300 rounded-md text-sm text-black focus:outline-none focus:ring-2 focus:ring-indigo-500"})}function P(){return{toast:e=>{let{title:t="Notice",description:a=""}=e;alert("".concat(t).concat(a?": "+a:""))}}}function L(e){let{label:t,file:a,onFileChange:n}=e;return(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsx)("label",{className:"text-sm font-medium text-gray-700",children:t}),(0,s.jsx)("input",{type:"file",accept:".pdf",onChange:e=>{let t=e.target.files[0];t&&n(t)},className:"block w-full text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 cursor-pointer focus:outline-none"}),a&&(0,s.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:["\uD83D\uDCC4 Selected: ",(0,s.jsx)("strong",{children:a.name})]})]})}y.GlobalWorkerOptions.workerSrc=S(),y.GlobalWorkerOptions.workerSrc=S();let _={available:"bg-green-100 text-green-800",reserved:"bg-yellow-100 text-yellow-800",service:"bg-red-100 text-red-800"};y.GlobalWorkerOptions.workerSrc="//cdnjs.cloudflare.com/ajax/libs/pdf.js/".concat(y.version,"/pdf.worker.min.js");let F=["HR","Sales","Finance","Production","Quality Control","Public Relations","Legal"],R={Onboarding:"\uD83D\uDCCB",NewHirePacket:"\uD83D\uDDC2️",EmployeeDirectoryManager:"\uD83D\uDCD7",CommunicationManager:"✉️",StatsReporter:"\uD83D\uDCCA",LeadTracker:"\uD83E\uDDF2",ProposalWriter:"\uD83D\uDCCC",BidSubmitter:"\uD83D\uDCC4",AwardMonitor:"\uD83C\uDFC6",EstimatingAgent:"\uD83D\uDCD0",AccountsReceivable:"\uD83D\uDCB0",AccountsPayable:"\uD83D\uDCB8",DocumentManager:"\uD83D\uDCC1",ContractLogger:"\uD83E\uDDFE",BudgetMonitor:"\uD83E\uDDEA",PreConstructionPlanner:"\uD83D\uDEA7",CrewScheduler:"\uD83D\uDC77",ProjectScheduler:"\uD83D\uDDD6",EquipmentAllocator:"\uD83D\uDD27",SpecValidator:"\uD83D\uDD0D",CustomerFeedback:"\uD83D\uDCE3",TrainingCoordinator:"\uD83D\uDCDA",JobsiteAuditor:"\uD83D\uDEB0",InternalEvents:"\uD83C\uDF89",MarketResearch:"\uD83D\uDCC8",WebsiteSEO:"\uD83C\uDF10",SocialMediaPublisher:"\uD83D\uDCF1",CEOUpdates:"\uD83D\uDCCB",LegalReview:"⚖️",BoardCommunicator:"\uD83D\uDCDD",RiskManager:"\uD83D\uDEA8"},E={HR:[{dept:"Onboarding",agent:"Onboarding",title:"Onboarding Agent",instructions:"Automates the new hire process: forms, routing, HR upload, and DocuSign.",component:()=>{let[e,t]=(0,l.useState)({name:"",payRate:"",position:"",phone:"",email:"",address:"",ssn:"",birthdate:"",files:{w4:null,i9:null,orw4:null,directDeposit:null,drugScreen:null,handbook:null}}),[a,n]=(0,l.useState)(null),r=a=>{let{name:s,value:n}=a.target;t((0,u._)((0,i._)({},e),{[s]:n}))},o=(a,s)=>{t((0,u._)((0,i._)({},e),{files:(0,u._)((0,i._)({},e.files),{[s]:a.target.files[0]})}))};return(0,s.jsx)("div",{className:"p-4",children:(0,s.jsx)(c,{className:"rounded-2xl shadow-md",children:(0,s.jsxs)(d,{className:"flex flex-col gap-4 p-6",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("span",{className:"text-2xl",children:"\uD83D\uDC69‍\uD83D\uDCBC"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-xl font-semibold",children:"Onboarding Agent"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Collects employee info, uploads documents, and runs light online scan."})]})]}),(0,s.jsx)("input",{type:"text",name:"name",placeholder:"Full Name",value:e.name,onChange:r,className:"border p-2 rounded"}),(0,s.jsx)("input",{type:"text",name:"payRate",placeholder:"Pay Rate",value:e.payRate,onChange:r,className:"border p-2 rounded"}),(0,s.jsx)("input",{type:"text",name:"position",placeholder:"Position",value:e.position,onChange:r,className:"border p-2 rounded"}),(0,s.jsx)("input",{type:"tel",name:"phone",placeholder:"Phone Number",value:e.phone,onChange:r,className:"border p-2 rounded"}),(0,s.jsx)("input",{type:"email",name:"email",placeholder:"Email",value:e.email,onChange:r,className:"border p-2 rounded"}),(0,s.jsx)("input",{type:"text",name:"address",placeholder:"Address",value:e.address,onChange:r,className:"border p-2 rounded"}),(0,s.jsx)("label",{className:"font-semibold text-gray-700",children:"Birthdate"}),(0,s.jsx)("input",{type:"date",name:"birthdate",value:e.birthdate,onChange:r,className:"border p-2 rounded"}),(0,s.jsx)("input",{type:"password",name:"ssn",placeholder:"SSN",value:e.ssn,onChange:r,className:"border p-2 rounded"}),(0,s.jsx)("div",{className:"grid grid-cols-2 gap-6 mt-6",children:[{label:"W-4",field:"w4"},{label:"I-9",field:"i9"},{label:"OR W-4",field:"orw4"},{label:"Direct Deposit",field:"directDeposit"},{label:"Drug Screen",field:"drugScreen"},{label:"Handbook Acknowledgment",field:"handbook"}].map(e=>{let{label:t,field:a}=e;return(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("label",{className:"font-semibold text-gray-700 mb-1",children:t}),(0,s.jsx)("input",{type:"file",onChange:e=>o(e,a),className:"border p-2 rounded bg-white"})]},a)})}),(0,s.jsxs)(m,{onClick:()=>{var t;console.log("Sending to Directory:",{name:e.name,phone:e.phone,email:e.email,address:e.address}),(null==(t=window.__DirectoryAgent__)?void 0:t.receive)&&window.__DirectoryAgent__.receive({name:e.name,phone:e.phone,email:e.email,address:e.address}),n("No public red flags found. Web scan completed.")},className:"mt-6",children:[(0,s.jsx)(N.A,{className:"mr-2 h-4 w-4"})," Submit"]}),a&&(0,s.jsxs)("div",{className:"mt-4 p-4 bg-green-100 text-green-800 rounded",children:["Online Scan Result: ",a]})]})})})}},{dept:"Employee Records",agent:"EmployeeDirectoryManager",title:"Directory Agent",instructions:"View and search stored employee contact info collected during onboarding.",component:()=>{let[e,t]=(0,l.useState)([]),[a,n]=(0,l.useState)("");window.__DirectoryAgent__={receive:e=>{t(t=>[...t,e])}};let r=e.filter(e=>e.name.toLowerCase().includes(a.toLowerCase())||e.phone.toLowerCase().includes(a.toLowerCase())||e.email.toLowerCase().includes(a.toLowerCase())||e.address.toLowerCase().includes(a.toLowerCase()));return(0,s.jsx)("div",{className:"p-4",children:(0,s.jsx)(c,{className:"rounded-2xl shadow-md",children:(0,s.jsxs)(d,{className:"flex flex-col gap-4 p-6",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("span",{className:"text-2xl",children:"\uD83D\uDCD7"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-xl font-semibold",children:"Employee Directory"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"A live record of all employee contact data entered by the Onboarding Agent."})]})]}),(0,s.jsx)("input",{type:"text",placeholder:"Search directory...",value:a,onChange:e=>n(e.target.value),className:"border p-2 rounded text-black"}),0===r.length?(0,s.jsx)("p",{className:"text-gray-500 italic",children:"No entries found."}):(0,s.jsx)("ul",{className:"space-y-2",children:r.map((e,t)=>(0,s.jsxs)("li",{className:"border p-3 rounded bg-gray-50",children:[(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Name:"})," ",e.name]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Phone:"})," ",e.phone]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Email:"})," ",e.email]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Address:"})," ",e.address]})]},t))}),(0,s.jsxs)(m,{className:"mt-4",disabled:!0,children:[(0,s.jsx)(N.A,{className:"mr-2 h-4 w-4"})," Listening for Entries"]})]})})})}}],Production:[{dept:"Scheduling",agent:"SchedulingAgent",title:"Scheduling Agent",instructions:"Pulls and schedules jobs using Google Calendar. Assign crews, equipment, and dates.",component:()=>{let[e,t]=(0,l.useState)(""),[a,n]=(0,l.useState)(""),[r,o]=(0,l.useState)(null),[c,d]=(0,l.useState)(!1),[m,h]=(0,l.useState)(null),[x,p]=(0,l.useState)(""),[g,b]=(0,l.useState)(""),[f,j]=(0,l.useState)(null),[w,y]=(0,l.useState)({bobcat:!0,auger:!0});(0,l.useEffect)(()=>{if(!("webkitSpeechRecognition"in window||"SpeechRecognition"in window))return;let e=new(window.SpeechRecognition||window.webkitSpeechRecognition);e.continuous=!1,e.lang="en-US",e.interimResults=!1,e.maxAlternatives=1,e.onresult=e=>{t(e.results[0][0].transcript)},j(e)},[]);let N=async()=>{n("Parsing...");try{let t=await v.A.post("http://localhost:5004/api/schedule/create",{inputText:e,equipmentAvailability:w});o(t.data.event||{}),d(!0),n(""),h(null)}catch(e){console.error("Scheduling failed:",e),n("❌ Scheduling failed.")}},C=async()=>{let{"start.dateTime":e,"end.dateTime":a,crew:s,equipment:l}=r;try{let o=await v.A.post("http://localhost:5004/api/schedule/check-conflicts",{start:e,end:a,crew:s,equipment:l});if(!1===o.data.ok){let e=o.data.conflicts.map(e=>"crew"===e.type?"Crew conflict with: ".concat(e.event.summary):"Equipment (".concat(e.item,") conflict with: ").concat(e.event.summary));h(e.join("\n"));return}let c=(0,u._)((0,i._)({},r),{colorId:(()=>{var e;let t=(null==(e=r.description)?void 0:e.toLowerCase())||"";return t.includes("boli")?"9":t.includes("standard")||t.includes("base")?"8":t.includes("l&i")||t.includes("washington")?"10":t.includes("davis bacon")?"3":void 0})()});await v.A.post("http://localhost:5004/api/schedule/confirm",c),n("✅ Event scheduled!"),d(!1),t("")}catch(e){console.error("Conflict check or final schedule post failed:",e),n("❌ Failed to confirm schedule.")}},k=e=>{y(t=>(0,u._)((0,i._)({},t),{[e]:!t[e]}))};return(0,s.jsxs)("div",{className:"p-4 space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-2xl font-bold mb-2",children:"Schedule a Job"}),(0,s.jsx)("input",{type:"text",placeholder:"e.g. Schedule Tara to install with Bobcat next Tuesday 9am",value:e,onChange:e=>t(e.target.value),className:"w-full p-2 border rounded"}),(0,s.jsxs)("div",{className:"flex gap-2 mt-2",children:[(0,s.jsx)("button",{onClick:N,className:"bg-blue-600 text-white px-4 py-2 rounded",children:"Review Schedule"}),(0,s.jsx)("button",{onClick:()=>{f&&f.start()},className:"bg-gray-600 text-white px-4 py-2 rounded",children:"\uD83C\uDFA4 Speak"})]}),(0,s.jsx)("p",{className:"text-sm mt-2",children:a})]}),(0,s.jsxs)("div",{className:"flex gap-4 mb-4",children:[(0,s.jsx)("input",{type:"text",placeholder:"Filter by crew",value:x,onChange:e=>p(e.target.value),className:"p-2 border rounded"}),(0,s.jsxs)("select",{value:g,onChange:e=>b(e.target.value),className:"p-2 border rounded",children:[(0,s.jsx)("option",{value:"",children:"All Types"}),(0,s.jsx)("option",{value:"boli",children:"BOLI"}),(0,s.jsx)("option",{value:"standard",children:"Standard"}),(0,s.jsx)("option",{value:"l&i",children:"L&I"}),(0,s.jsx)("option",{value:"davis bacon",children:"Davis Bacon"})]})]}),(0,s.jsxs)("div",{className:"flex gap-6 text-sm items-center",children:[(0,s.jsx)("div",{children:"Equipment Toggle:"}),Object.entries(w).map(e=>{let[t,a]=e;return(0,s.jsxs)("label",{className:"flex gap-1 items-center",children:[(0,s.jsx)("input",{type:"checkbox",checked:a,onChange:()=>k(t)}),t.charAt(0).toUpperCase()+t.slice(1)]},t)})]}),(0,s.jsxs)("div",{className:"flex gap-4 mt-4 text-sm",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"w-4 h-4 bg-blue-500 inline-block"})," BOLI"]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"w-4 h-4 bg-gray-400 inline-block"})," Standard"]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"w-4 h-4 bg-green-500 inline-block"})," L&I"]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"w-4 h-4 bg-purple-500 inline-block"})," Davis Bacon"]})]}),(0,s.jsx)("div",{className:"calendar-container rounded overflow-hidden shadow",children:(0,s.jsx)("iframe",{src:"https://calendar.google.com/calendar/embed?src=".concat(encodeURIComponent("blcto2tpkhisonlouirt5kql4c@group.calendar.google.com"),"&ctz=America%2FLos_Angeles"),style:{border:0},width:"100%",height:"700",frameBorder:"0",scrolling:"no",title:"Zochert Calendar"})}),c&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,s.jsxs)("div",{className:"bg-white p-6 rounded shadow-lg w-full max-w-lg",children:[(0,s.jsx)("h3",{className:"text-xl font-bold mb-4",children:"Confirm Event"}),(0,s.jsxs)("ul",{className:"text-sm space-y-1",children:[(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Summary:"})," ",r.summary]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Location:"})," ",r.location]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Start:"})," ",r["start.dateTime"]]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"End:"})," ",r["end.dateTime"]]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Description:"})," ",r.description]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Crew:"})," ",r.crew]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Equipment:"})," ",(r.equipment||[]).join(", ")]})]}),m&&(0,s.jsxs)("div",{className:"mt-4 text-red-600 whitespace-pre-line text-sm border border-red-300 bg-red-50 p-2 rounded",children:["⚠️ Conflicts detected:",(0,s.jsx)("br",{}),m]}),(0,s.jsxs)("div",{className:"mt-4 flex justify-end gap-4",children:[(0,s.jsx)("button",{className:"px-4 py-2 bg-gray-300 rounded",onClick:()=>d(!1),children:"Cancel"}),(0,s.jsx)("button",{className:"px-4 py-2 bg-green-600 text-white rounded",onClick:C,disabled:!!m,children:"Confirm"})]})]})})]})}},{dept:"Fleet",agent:"FleetAgent",title:"Fleet Management Agent",instructions:"Manages the service, files, logs, and availability of the truck and equipment fleet.",component:()=>{let[e,t]=(0,l.useState)([]),[a,n]=(0,l.useState)(""),[r,i]=(0,l.useState)(""),[o,c]=(0,l.useState)(""),d=async()=>{try{let e=await v.A.get("http://localhost:5005/api/fleet");t(e.data),c("")}catch(e){console.error("Fetch failed:",e),c("❌ Could not load fleet data")}};(0,l.useEffect)(()=>{d()},[]);let u=async(e,t)=>{try{await v.A.post("http://localhost:5005/api/fleet/".concat(e,"/status"),{status:t}),d()}catch(e){console.error("Status update failed:",e),c("❌ Failed to update equipment status")}},m=async()=>{if(!a.trim()||!r.trim())return void c("⚠️ Name and type required.");try{await v.A.post("http://localhost:5005/api/fleet",{name:a.trim(),type:r.trim(),status:"available"}),n(""),i(""),d()}catch(e){console.error("Add failed:",e),c("❌ Failed to add equipment")}};return(0,s.jsxs)("div",{className:"p-4 space-y-4",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold mb-2",children:"Fleet Manager"}),(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"Manage truck and equipment status."}),o&&(0,s.jsx)("p",{className:"text-red-600",children:o}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("input",{type:"text",placeholder:"Equipment name",value:a,onChange:e=>n(e.target.value),className:"p-2 border rounded w-1/3"}),(0,s.jsx)("input",{type:"text",placeholder:"Type (e.g., Bobcat)",value:r,onChange:e=>i(e.target.value),className:"p-2 border rounded w-1/3"}),(0,s.jsx)("button",{onClick:m,className:"bg-blue-600 text-white px-4 py-2 rounded",children:"➕ Add"})]}),(0,s.jsxs)("table",{className:"w-full text-sm border mt-4",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:"bg-gray-100 text-left",children:[(0,s.jsx)("th",{className:"p-2",children:"Name"}),(0,s.jsx)("th",{className:"p-2",children:"Type"}),(0,s.jsx)("th",{className:"p-2",children:"Status"}),(0,s.jsx)("th",{className:"p-2",children:"Actions"})]})}),(0,s.jsx)("tbody",{children:e.map(e=>(0,s.jsxs)("tr",{className:"border-t",children:[(0,s.jsx)("td",{className:"p-2 font-medium",children:e.name}),(0,s.jsx)("td",{className:"p-2",children:e.type}),(0,s.jsx)("td",{className:"p-2",children:(0,s.jsx)("span",{className:"px-2 py-1 rounded ".concat(_[e.status]),children:e.status})}),(0,s.jsx)("td",{className:"p-2 flex flex-wrap gap-1",children:Object.keys(_).map(t=>(0,s.jsxs)("button",{onClick:()=>u(e.id,t),className:"px-2 py-1 border rounded text-xs",children:["Mark ",t]},t))})]},e.id))})]})]})}}],Legal:[{dept:"Contract Law Review",agent:"LegalReview",title:"Legal Review Agent",instructions:"Upload the GC contract and Zochert proposal PDFs. The agent will scan for legal red flags and mismatches.",component:function(e){let{open:t,onClose:a,agent:n,dept:r}=e,[i,o]=(0,l.useState)(!1),[c,d]=(0,l.useState)(null),[u,h]=(0,l.useState)(null),[g,N]=(0,l.useState)(null),v=async e=>{let t=await e.arrayBuffer(),a=await (0,y.getDocument)({data:t}).promise,s="";for(let e=1;e<=a.numPages;e++){let t=await a.getPage(e);s+=(await t.getTextContent()).items.map(e=>e.str).join(" ")+"\n"}return s},k=async()=>{if(o(!0),d("Analyzing contract and proposal..."),!u||!g){d("⚠️ Please upload both the GC contract and Zochert proposal."),o(!1);return}try{var e,t,a;let s=await v(u),n=await v(g),l=[];s.toLowerCase().includes("general liability")||l.push("⚠️ Missing 'General Liability' clause in GC contract."),s.toLowerCase().includes("indemnify")||l.push("⚠️ No indemnity language found in GC contract."),s.toLowerCase().includes("payment terms")||s.toLowerCase().includes("net")||l.push("⚠️ No clear payment terms in GC contract.");let r=await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(A.env.REACT_APP_OPENAI_API_KEY)},body:JSON.stringify({model:"gpt-4",messages:[{role:"system",content:"You are a construction subcontract legal expert. Carefully review the provided GC contract and subcontractor proposal.\nFlag anything unusual or high-risk. Focus especially on:\n- Missing or unfavorable indemnity terms\n- Insurance requirements (e.g. General Liability, Auto, Umbrella, Workers Comp)\n- Payment timelines or conditions (e.g. Pay-When-Paid)\n- Scope mismatches\n- Liquidated damages or backcharges\n- Conflict resolution and termination clauses\n- Check for any bad press or pending lawsuits with the client or General Contractor\n- Check for special bading requirments for Zochert employees\n- Check local laws for where job is to be performened, make sure they match contract"},{role:"user",content:"GC Contract:\n".concat(s.slice(0,8e3))},{role:"user",content:"Zochert Proposal:\n".concat(n.slice(0,8e3))}],temperature:.3})}),i=await r.json();(null==i||null==(a=i.choices)||null==(t=a[0])||null==(e=t.message)?void 0:e.content)?d("\uD83E\uDDE0 AI Legal Review:\n\n".concat(i.choices[0].message.content)):(console.error(i),d("⚠️ Failed to retrieve analysis from AI."))}catch(e){console.error(e),d("❌ Error processing PDF files or connecting to AI.")}o(!1)};return(0,s.jsxs)(x,{open:t,onOpenChange:a,children:[(0,s.jsx)(p,{asChild:!0}),(0,s.jsxs)(b,{className:"max-w-md max-h-[90vh] overflow-y-auto bg-gray-900 border border-gray-600 text-white top-[10%] left-1/2 transform -translate-x-1/2 p-4",children:[(0,s.jsxs)(f,{children:[(0,s.jsxs)(j,{className:"text-2xl font-bold text-black",children:["⚖️ ",n]}),(0,s.jsxs)(w,{className:"text-sm text-black mt-1",children:["This AI agent supports the ",(0,s.jsx)("strong",{children:r})," department."]})]}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{htmlFor:"gc-upload",className:"text-sm font-medium text-black",children:"Upload GC Contract (PDF)"}),(0,s.jsx)("input",{type:"file",accept:"application/pdf",id:"gc-upload",onChange:e=>h(e.target.files[0]),className:"w-full mt-1 block"}),u&&(0,s.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:["Uploaded: ",u.name.slice(0,15),u.name.length>15?"…":""]})]}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{htmlFor:"zochert-upload",className:"text-sm font-medium text-black",children:"Upload Zochert Proposal (PDF)"}),(0,s.jsx)("input",{type:"file",accept:"application/pdf",id:"zochert-upload",onChange:e=>N(e.target.files[0]),className:"w-full mt-1 block"}),g&&(0,s.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:["Uploaded: ",g.name.slice(0,15),g.name.length>15?"…":""]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(m,{onClick:k,disabled:i,className:"w-full bg-green-600 hover:bg-green-700",children:i?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(C.A,{className:"mr-2 h-4 w-4 animate-spin"})," Reviewing..."]}):"\uD83D\uDE80 Run ".concat(n)}),c&&(0,s.jsx)("div",{className:"p-4 bg-gray-700 border border-gray-600 rounded-lg text-sm text-gray-100 whitespace-pre-wrap",children:c})]})]})]})}}],Finance:[{dept:"Planning",agent:"FinancialPlanningAgent",title:"Financial Planning Agent",instructions:"Analyzes budgets, cash flow, and future projections. Connects with financial systems.",component:()=>{let[e,t]=(0,l.useState)([]),[a,n]=(0,l.useState)(!1),[r,i]=(0,l.useState)(null),o=async()=>{n(!0),i(null);try{let e=await v.A.post("http://localhost:4000/api/fetch-unpaid-bills");t(e.data.QueryResponse.Bill||[])}catch(e){console.error("Failed to fetch bills:",e),i("Failed to fetch bills. Check console for details.")}finally{n(!1)}};return(0,s.jsx)("div",{className:"p-4",children:(0,s.jsx)(c,{className:"rounded-2xl shadow-md",children:(0,s.jsxs)(d,{className:"flex flex-col items-start gap-4 p-6",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("span",{className:"text-2xl",children:"\uD83D\uDCB8"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-xl font-semibold",children:"Financial Planning Agent"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Tracks job costs and automates bill payments by billing period."})]})]}),(0,s.jsxs)(m,{onClick:o,className:"mt-2",children:[(0,s.jsx)(N.A,{className:"mr-2 h-4 w-4"})," Fetch Unpaid Bills"]}),a&&(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Loading bills..."}),r&&(0,s.jsx)("p",{className:"text-sm text-red-500",children:r}),e.length>0&&(0,s.jsxs)("div",{className:"mt-4 w-full",children:[(0,s.jsx)("h3",{className:"font-semibold mb-2",children:"Unpaid Bills"}),(0,s.jsx)("ul",{className:"space-y-3",children:e.map(e=>{var t,a;return(0,s.jsxs)("li",{className:"border border-gray-300 rounded p-3 bg-gray-50 text-sm",children:[(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Vendor:"})," ",(null==(t=e.VendorRef)?void 0:t.name)||"N/A"]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Date:"})," ",e.TxnDate]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Due:"})," ",e.DueDate]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Balance:"})," $",e.Balance]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Job/Customer:"})," ",(null==(a=e.CustomerRef)?void 0:a.name)||"N/A"]})]},e.Id)})})]})]})})})}}],Sales:[{dept:"Leads",agent:"LeadAgent",title:"Lead Agent",instructions:"Find projects that have fence and/or gates for us to bid. This agent will find projects and download plans and specifications.",component:function(){let{toast:e}=P(),[t,a]=(0,l.useState)(!1),[n,r]=(0,l.useState)(""),i=async()=>{a(!0),r(""),e({title:"\uD83D\uDD0D Running LeadAgent..."});try{let t=await fetch("http://localhost:3003/run-lead-agent",{method:"POST"});if(!t.ok)throw Error("Server error running LeadAgent");let a=await t.json();r(a.message||"✅ LeadAgent run completed."),e({title:"✅ LeadAgent finished"})}catch(t){console.error(t),e({title:"❌ Failed to run LeadAgent"}),r("Error running LeadAgent. Check server logs.")}finally{a(!1)}};return(0,s.jsx)(c,{className:"w-full shadow-xl rounded-2xl p-4",children:(0,s.jsxs)(d,{className:"flex flex-col gap-4",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold",children:"\uD83D\uDCE1 LeadAgent"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Scans PlanCenterNW.com for fencing leads in OR/WA."}),(0,s.jsx)(m,{onClick:i,disabled:t,children:t?"Running...":"Run LeadAgent"}),n&&(0,s.jsx)("div",{className:"mt-4 p-3 bg-gray-100 rounded text-sm whitespace-pre-wrap text-black",children:n})]})})}},{dept:"Bidding/Estimating",agent:"TakeoffAgent",title:"Takeoff Agent",instructions:"Upload plans and describe scope. This agent will generate a full material list, cost summary, and optionally a submittal.",component:function(){let{toast:e}=P(),[t,a]=(0,l.useState)(""),[n,r]=(0,l.useState)(null),[i,o]=(0,l.useState)(null),[u,h]=(0,l.useState)(""),[x,p]=(0,l.useState)(!1),g=(0,l.useRef)(null),b=(0,l.useRef)(null),[f,j]=(0,l.useState)(0),[w,N]=(0,l.useState)(1),[v,C]=(0,l.useState)(0),[k,S]=(0,l.useState)(1);(0,l.useEffect)(()=>{(async(e,t,a,s)=>{if(!e||!t.current)return;let n=new FileReader;n.onload=async function(){try{let e=new Uint8Array(this.result),n=await y.getDocument({data:e}).promise;a(n.numPages);let l=await n.getPage(s),r=l.getViewport({scale:.5}),i=t.current,o=i.getContext("2d");i.height=r.height,i.width=r.width,await l.render({canvasContext:o,viewport:r}).promise}catch(e){console.error("Error rendering PDF:",e)}},n.readAsArrayBuffer(e)})(n,g,j,w)},[n,w]),(0,l.useEffect)(()=>{(async(e,t,a,s)=>{if(!e||!t.current)return;let n=new FileReader;n.onload=async function(){try{let e=new Uint8Array(this.result),n=await y.getDocument({data:e}).promise;a(n.numPages);let l=await n.getPage(s),r=l.getViewport({scale:.5}),i=t.current,o=i.getContext("2d");i.height=r.height,i.width=r.width,await l.render({canvasContext:o,viewport:r}).promise}catch(e){console.error("Error rendering PDF:",e)}},n.readAsArrayBuffer(e)})(i,b,C,k)},[i,k]);let A=async()=>{if(!n)return void e({title:"Please upload a plan file."});let t=new FormData;for(let e of(t.append("plans",n),i&&t.append("specs",i),t.entries()))console.log("\uD83E\uDDFE FormData Field:",e[0],e[1]);p(!0),h("");try{let e=await fetch("http://localhost:3002/analyze",{method:"POST",body:t});if(!e.ok)throw Error("Server returned an error");let a=await e.json();h(a.result||"✅ Plan processed, but no output returned.")}catch(t){console.error("Takeoff error:",t),e({title:"Failed to analyze plan file."})}finally{p(!1)}};return(0,s.jsx)(c,{className:"w-full shadow-xl rounded-2xl p-4",children:(0,s.jsxs)(d,{className:"flex flex-col gap-4",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold",children:"\uD83D\uDCD0 Takeoff Agent"}),(0,s.jsx)(D,{placeholder:"Describe scope (e.g., 10' tall CLF with 3 rails and 2 gates)...",value:t,onChange:e=>a(e.target.value)}),(0,s.jsx)(L,{label:"Upload Plan PDF",file:n,onFileChange:r}),(0,s.jsx)(L,{label:"Upload Specifications PDF/DOC",file:i,onFileChange:o}),(0,s.jsx)(m,{onClick:A,disabled:x,children:x?"Running...":"Run Estimate"}),(0,s.jsxs)("div",{className:"flex gap-4 mt-4",children:[(0,s.jsxs)("div",{className:"flex gap-4",children:[n&&(0,s.jsxs)("div",{className:"w-[200px]",children:[(0,s.jsx)("h3",{className:"text-md font-semibold text-black mb-1",children:"Plan Preview"}),(0,s.jsx)("canvas",{ref:g,className:"border rounded shadow mb-1 max-w-full h-auto"}),(0,s.jsxs)("div",{className:"flex justify-between text-xs text-black",children:[(0,s.jsx)("button",{disabled:w<=1,onClick:()=>N(e=>e-1),className:"bg-gray-300 px-2 py-1 rounded disabled:opacity-50",children:"◀ Prev"}),(0,s.jsxs)("span",{children:["Page ",w," of ",f]}),(0,s.jsx)("button",{disabled:w>=f,onClick:()=>N(e=>e+1),className:"bg-gray-300 px-2 py-1 rounded disabled:opacity-50",children:"Next ▶"})]})]}),i&&(0,s.jsxs)("div",{className:"w-[200px]",children:[(0,s.jsx)("h3",{className:"text-md font-semibold text-black mb-1",children:"Spec Preview"}),(0,s.jsx)("canvas",{ref:b,className:"border rounded shadow mb-1 max-w-full h-auto"}),(0,s.jsxs)("div",{className:"flex justify-between text-xs text-black",children:[(0,s.jsx)("button",{disabled:k<=1,onClick:()=>S(e=>e-1),className:"bg-gray-300 px-2 py-1 rounded disabled:opacity-50",children:"◀ Prev"}),(0,s.jsxs)("span",{children:["Page ",k," of ",v]}),(0,s.jsx)("button",{disabled:k>=v,onClick:()=>S(e=>e+1),className:"bg-gray-300 px-2 py-1 rounded disabled:opacity-50",children:"Next ▶"})]})]})]}),(0,s.jsx)("div",{className:"flex-1 max-h-[600px] overflow-auto bg-gray-100 p-4 rounded-md whitespace-pre-wrap text-black",children:u||"Upload a file and click Run Estimate to begin."})]})]})})}}]};function O(){var e;let{data:t,status:a}=(0,n.useSession)(),[r,i]=(0,l.useState)(F[0]),[o,u]=(0,l.useState)(null),[h,g]=(0,l.useState)(null),[y,N]=(0,l.useState)(""),[v,C]=(0,l.useState)(""),k=e=>{let{agent:t,dept:a,component:s,title:n,instructions:l}=e;u({agent:t,dept:a,component:s,title:n,instructions:l}),g(null),N(""),C("")};return"loading"===a?(0,s.jsx)("div",{className:"p-10 text-center text-gray-700 text-lg",children:"Loading session..."}):t?(0,s.jsxs)("div",{className:"p-8 bg-gradient-to-br from-gray-50 via-gray-100 to-white bg-opacity-70 min-h-screen font-sans text-white",children:[(0,s.jsx)("div",{className:"flex justify-end mb-6",children:(0,s.jsxs)(m,{onClick:()=>(0,n.signOut)(),className:"bg-red-600 text-white px-4 py-2 rounded-full hover:bg-red-700",children:["Sign Out (",t.user.name,")"]})}),(0,s.jsxs)("div",{className:"flex flex-col items-center mb-10",children:[(0,s.jsx)("img",{src:"/dc.png",alt:"DreamCon Logo",className:"h-72 mb-6 object-contain bg-transparent"}),(0,s.jsx)("h1",{className:"text-5xl font-extrabold text-center text-gray-700 drop-shadow-sm tracking-tight",children:"AI Agent"})]}),(0,s.jsx)("div",{className:"mb-8 overflow-x-auto",children:(0,s.jsx)("div",{className:"inline-flex gap-4 px-4 py-2 rounded-full bg-gray-700 shadow-inner border border-gray-600 w-full justify-center",children:F.map(e=>(0,s.jsx)("button",{onClick:()=>i(e),className:"w-48 h-14 flex items-center justify-center rounded-full text-md font-semibold transition-all shadow-md ".concat(r===e?"bg-gray-300 text-gray-800":"bg-gray-600 text-white hover:bg-indigo-300 hover:text-black"),children:e},e))})}),(0,s.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-10",children:null==(e=E[r])?void 0:e.map(e=>{let{dept:t,agent:a,component:n,title:l,instructions:r}=e;return(0,s.jsx)(c,{className:"shadow-md border border-gray-700 rounded-xl bg-gray-700 hover:shadow-lg transition-transform duration-300",children:(0,s.jsxs)(d,{className:"p-6 relative bg-gray-700 rounded-xl",children:[(0,s.jsx)("div",{className:"absolute top-4 right-4 bg-white text-gray-800 w-20 h-20 flex items-center justify-center text-3xl font-bold rounded-full shadow-lg",children:R[a]||"\uD83E\uDD16"}),(0,s.jsx)("h2",{className:"text-lg font-semibold text-white mb-1 tracking-wide",children:l||t}),(0,s.jsxs)("p",{className:"text-sm text-white italic mb-4",children:["Agent:"," ",(0,s.jsx)("span",{className:"font-medium text-white",children:a})]}),(0,s.jsxs)(x,{open:(null==o?void 0:o.agent)===a,onOpenChange:e=>u(e?{agent:a,dept:t,component:n,title:l,instructions:r}:null),children:[(0,s.jsx)(p,{asChild:!0,children:(0,s.jsx)(m,{variant:"default",size:"sm",className:"bg-indigo-600 text-white hover:bg-indigo-700 rounded-full px-4",onClick:()=>k({agent:a,dept:t,component:n,title:l,instructions:r}),children:"Open Agent"})}),(null==o?void 0:o.agent)===a&&n&&(0,s.jsxs)(b,{className:"max-w-4xl max-h-[90vh] overflow-y-auto bg-white text-black rounded-xl p-6",children:[(0,s.jsxs)(f,{className:"text-black",children:[(0,s.jsx)(j,{className:"text-2xl font-bold text-black",children:l}),(0,s.jsx)(w,{className:"text-sm text-black",children:r})]}),(0,s.jsx)("div",{className:"mt-4",children:(0,s.jsx)(n,{open:(null==o?void 0:o.agent)===a,onClose:()=>u(null),agent:a,dept:t})})]})]})]})},"".concat(t,"-").concat(a))})})]}):(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gray-100",children:[(0,s.jsx)("img",{src:"/dc.png",alt:"DreamCon Logo",className:"h-72 mb-6"}),(0,s.jsx)("h1",{className:"text-4xl font-bold mb-4 text-gray-800",children:"AI Agent Dashboard"}),(0,s.jsx)("p",{className:"mb-6 text-gray-600",children:"You must be signed in to continue."}),(0,s.jsx)(m,{onClick:()=>(0,n.signIn)("github"),className:"bg-indigo-600 text-white px-6 py-2 rounded-full hover:bg-indigo-700",children:"Sign in with GitHub"})]})}function T(){let{data:e,status:t}=(0,n.useSession)();return"loading"===t?(0,s.jsx)("div",{children:"Loading..."}):e?(0,s.jsx)(O,{}):(0,s.jsx)(r,{})}}},e=>{var t=t=>e(e.s=t);e.O(0,[57,31,453,636,593,792],()=>t(2936)),_N_E=e.O()}]);